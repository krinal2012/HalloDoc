@{
    Layout = "_AdminDashboardLayout";
    ViewData["Title"] = "Invoicing";
}
@using HalloDoc.Entity.Models.ViewModel;
@using static HalloDoc.Entity.Models.Constant;
@model TimesheetModel;
<div class="container">
    
    <div class="d-flex justify-content-between align-items-center container pb-1 mt-4">
        <div class="d-flex align-self-center">
            <h3>Timesheets</h3>
        </div>
        <div class=" btn d-flex justify-content-end">
            <a class="btn border border-info text-info shadow-none" asp-action="Index" asp-controller="Invoicing">
                <i class="fa fa-angle-left pe-1 text-info"> </i> Back
            </a>
        </div>
    </div>
    <form>
        <input type="hidden" asp-for="startDate" value="@Model.startDate" id="startdate" />
        <input type="hidden" asp-for="endDate" value="@Model.endDate" id="endDate" />
        <div class="bg-white reqform container p-3 ">
            <table class="table mt-3">
                <tr class="table-secondary">
                    <th> Date</th>
                    <th>On Call Hours</th>
                    <th>Total Hours</th>
                    <th>Weekend/Holidays</th>
                    <th>Number of Housecall</th>
                    <th>Number of Consult</th>
                </tr>

                @for (var i = Model.startDate.Date; i <= Model.endDate.Date; i = i.AddDays(1))
                {
                    <tr>
                        <td>@i.ToString("dd/MM/yyyy")</td>
                        <td class="text-center">
                            0
                        </td>
                        <td>
                            <input type="number" name="TotalHours" class="form-control">
                        </td>
                        <td class="text-center">
                            <input class="form-check-input" type="checkbox" name="IsWeekend">
                        </td>
                        <td>
                            <input type="number" name="NoofHousecall" class="form-control">
                        </td>
                        <td>
                            <input type="number" name="NoofPhoneConsult" class="form-control">
                        </td>

                    </tr>
                }

            </table>
            <butoon type="button" class="btn btn-info" onclick="submitform()">Submit</butoon>
        </div>
    </form>
    <button class="btn btn-info mt-2">Add Receipts</button>
    <div class="bg-white reqform container p-3 mt-3" style="display:none;">
        <table class="table ">
            <tr class="table-secondary">
                <th>Date</th>
                <th>Item</th>
                <th>Amount</th>
                <th>Bill</th>
                <th>Action</th>
            </tr>
        </table>
    </div>
    <div class="d-flex justify-content-end">
        <button class="btn btn-info ">Finalize</button>
    </div>
</div>
<script>

    function submitform() {

        let TotalHoursList = [];
        $('input[name="TotalHours"]').each(function () {
            TotalHoursList.push($(this).val());
        });
        console.log(TotalHoursList);
        let IsWeekendList = [];
        $('input[name="IsWeekend"]').each(function () {
            IsWeekendList.push($(this).is(':checked'));
        });
        console.log(IsWeekendList);
        let NoofHousecallList = [];
        $('input[name="NoofHousecall"]').each(function () {
            NoofHousecallList.push($(this).val());
        });
        console.log(NoofHousecallList);
        let NoofPhoneConsultList = [];
        $('input[name="NoofPhoneConsult"]').each(function () {
            NoofPhoneConsultList.push($(this).val());
        });
        console.log(NoofPhoneConsultList);
        var sendInfo = {
            startDate: $("#startdate").val(),
            endDate: $("#endDate").val(),
            TotalHours: TotalHoursList,
            IsWeekend: IsWeekendList,
            NoofHousecall: NoofHousecallList,
            NoofPhoneConsult: NoofPhoneConsultList
        }
        $.ajax({
            type: "POST",
            url: '@Url.Action("TimeSheetSave", "Invoicing")',
            dataType: 'json', // Set the content type as JSON
            data: sendInfo,
            success: function (data) {
                console.log("AJAX success");
                location.reload();
            },
            error: function (error) {
                console.log("Error:", error);
            }
        });
    }
</script>